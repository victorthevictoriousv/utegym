<template>
  <section class="event container">
    <header>
      <div class="event__time">
        <p><span>{{ this.daysLeft[0] }}</span><span>{{ this.daysLeft[1] }}</span></p>
        <p>Dagar <br /> kvar</p>
      </div>
      <h1>{{ event.name }}</h1>
    </header>
    <div>
      <img class="event__hero" :src="$store.getters['gyms/getGymById'](event.gymId).photo" alt="img">
      <div class="event__details">
        <div>
          {{ event.date.day }} <br /> {{ event.date.month }}
        </div>
        <div>
          <nuxt-link tag="h3" :to="'/gyms/' + $store.getters['gyms/getGymById'](event.gymId).name + '?id=' + event.gymId">{{ $store.getters['gyms/getGymById'](event.gymId).name }}</nuxt-link>
          <p>{{ event.time }}</p>
        </div>
      </div>
    </div> 
    <footer class="event__footer">
      <nav>
        <ul>
          <li class="event--social">
            <svg id="social" aria-label="social" @click="share = !share" xmlns="http://www.w3.org/2000/svg" width="44" height="44" viewBox="0 0 44 44">
              <path fill="#BFF683" d="M35.73875,28.259375 C33.3420428,28.2640015 31.08052,29.3702187 29.605625,31.259375 L16.27625,24.449375 C16.4654297,23.7880662 16.5663045,23.1046391 16.57625,22.416875 C16.5646066,21.6691415 16.4446083,20.9270466 16.22,20.21375 L29.495,13.42625 C31.8160128,16.4746125 36.0043679,17.3914041 39.3866347,15.591436 C42.7689016,13.7914679 44.3480339,9.80534619 43.1160703,6.17741568 C41.8841066,2.54948516 38.2042131,0.349210423 34.4252688,0.981028647 C30.6463245,1.61284687 27.8823108,4.89050664 27.8975,8.721875 C27.9071605,9.41164189 28.0086787,10.0970471 28.199375,10.76 L14.86625,17.579375 C12.7892168,14.9364027 9.25918616,13.9104118 6.08906702,15.0283181 C2.91894789,16.1462243 0.81333912,19.1595589 0.853612926,22.5207711 C0.893886732,25.8819834 3.07109175,28.8440016 6.26708627,29.8856295 C9.46308079,30.9272574 12.9675148,29.8169802 14.980625,27.125 L28.25,33.9125 C28.024477,34.6275661 27.9038466,35.3715588 27.891875,36.12125 C27.8980873,40.4560486 31.4164395,43.9654495 35.7512398,43.9606192 C40.0860402,43.955789 43.5965627,40.4385558 43.5931145,36.1037542 C43.5896663,31.7689525 40.0735525,28.2573089 35.73875,28.259375 L35.73875,28.259375 Z"/>
            </svg>
            <transition name="event__social">
              <ul v-if="share" class="event__social"> 
                <li>
                  <a href="#" aria-label="share on facebook">
                    <svg xmlns="http://www.w3.org/2000/svg" width="45" height="45" viewBox="0 0 45 45">
                      <g fill="none">
                        <circle cx="22.34" cy="22.34" r="22.34" fill="#3B5998"/>
                        <path fill="#FFF" d="M27.9561504,23.2144248 L23.9698673,23.2144248 L23.9698673,37.8183186 L17.9303097,37.8183186 L17.9303097,23.2144248 L15.0578761,23.2144248 L15.0578761,18.0820354 L17.9303097,18.0820354 L17.9303097,14.7607965 C17.9303097,12.3857522 19.0584956,8.66668142 24.0236283,8.66668142 L28.4973451,8.68539823 L28.4973451,13.6672566 L25.2513717,13.6672566 C24.7189381,13.6672566 23.9702655,13.9332743 23.9702655,15.0662389 L23.9702655,18.0868142 L28.4838053,18.0868142 L27.9561504,23.2144248 Z"/>
                      </g>
                    </svg>
                  </a>
                </li>
                <li>
                  <a href="#" aria-label="share on whatsapp">
                    <svg xmlns="http://www.w3.org/2000/svg" width="45" height="45" viewBox="0 0 45 45">
                      <g fill="none">
                        <path fill="#4CAF50" d="M22.505625,0 L22.494375,0 L22.494375,0 C10.0884375,0 0,10.09125 0,22.5 C0,27.421875 1.58625,31.98375 4.2834375,35.6878125 L1.479375,44.0465625 L10.1278125,41.281875 C13.685625,43.63875 17.9296875,45 22.505625,45 C34.9115625,45 45,34.9059375 45,22.5 C45,10.0940625 34.9115625,0 22.505625,0 Z"/>
                        <path fill="#FAFAFA" d="M35.5978125,31.7728125 C35.055,33.305625 32.900625,34.576875 31.1821875,34.948125 C30.0065625,35.1984375 28.4709375,35.398125 23.3015625,33.255 C16.689375,30.515625 12.43125,23.7965625 12.099375,23.360625 C11.7815625,22.9246875 9.4275,19.8028125 9.4275,16.5740625 C9.4275,13.3453125 11.0671875,11.773125 11.728125,11.098125 C12.2709375,10.5440625 13.168125,10.2909375 14.02875,10.2909375 C14.3071875,10.2909375 14.5575,10.305 14.7825,10.31625 C15.4434375,10.344375 15.7753125,10.38375 16.21125,11.4271875 C16.7540625,12.735 18.0759375,15.96375 18.2334375,16.295625 C18.39375,16.6275 18.5540625,17.0775 18.3290625,17.5134375 C18.118125,17.9634375 17.9325,18.163125 17.600625,18.545625 C17.26875,18.928125 16.95375,19.220625 16.621875,19.63125 C16.318125,19.9884375 15.975,20.3709375 16.3575,21.031875 C16.74,21.67875 18.061875,23.8359375 20.008125,25.5684375 C22.5196875,27.804375 24.5559375,28.51875 25.284375,28.8225 C25.8271875,29.0475 26.4740625,28.9940625 26.870625,28.5721875 C27.3740625,28.029375 27.995625,27.129375 28.6284375,26.2434375 C29.0784375,25.6078125 29.6465625,25.5290625 30.2428125,25.7540625 C30.8503125,25.965 34.065,27.5540625 34.7259375,27.883125 C35.386875,28.215 35.8228125,28.3725 35.983125,28.6509375 C36.140625,28.929375 36.140625,30.2371875 35.5978125,31.7728125 Z"/>
                      </g>
                    </svg>
                  </a>
                </li>
                <li>
                  <a href="#" aria-label="share on twitter">
                    <svg xmlns="http://www.w3.org/2000/svg" width="45" height="45" viewBox="0 0 45 45">
                      <g fill="none">
                        <circle cx="22.34" cy="22.34" r="22.34" fill="#55ACEE"/>
                        <path fill="#FFF" d="M36.024292,16.0550442 C35.0669469,16.4795575 34.0371239,16.7666814 32.9571239,16.8949115 C34.059823,16.2342478 34.9060619,15.1888938 35.3054867,13.9412389 C34.2736726,14.5533186 33.130354,14.9973451 31.9145575,15.2366814 C30.9404867,14.199292 29.5526549,13.5509735 28.015885,13.5509735 C25.0673894,13.5509735 22.6760177,15.9423451 22.6760177,18.8908407 C22.6760177,19.3093805 22.7234071,19.7167699 22.815,20.1078319 C18.3771239,19.8852212 14.4422124,17.759469 11.8083186,14.5278319 C11.3487611,15.3163274 11.0851327,16.2342478 11.0851327,17.2126991 C11.0851327,19.0648673 12.0285398,20.7 13.4605752,21.6573451 C12.5856637,21.6298673 11.7617257,21.3897345 11.0421239,20.9887168 C11.0417257,21.0114159 11.0417257,21.034115 11.0417257,21.0564159 C11.0417257,23.6437168 12.8831416,25.8017257 15.3254867,26.2919469 C14.8778761,26.4146018 14.405177,26.4795133 13.9189381,26.4795133 C13.5740708,26.4795133 13.2399558,26.4464602 12.9142035,26.3843363 C13.5935841,28.5053097 15.5652212,30.0492478 17.9024336,30.0926549 C16.0745575,31.5250885 13.7723894,32.3784956 11.2699115,32.3784956 C10.839823,32.3784956 10.4137168,32.3534071 9.99676991,32.3036283 C12.3586726,33.819292 15.1661947,34.7029646 18.1815929,34.7029646 C28.0035398,34.7029646 33.3748673,26.5663274 33.3748673,19.509292 C33.3748673,19.2779204 33.3696903,19.0473451 33.3593363,18.8187611 C34.4034956,18.0661062 35.3086726,17.125885 36.024292,16.0550442 L36.024292,16.0550442 Z"/>
                      </g>
                    </svg>
                  </a>
                </li>
              </ul>
            </transition>
          </li>
          <li>
            <a :href="$store.getters['gyms/getGymById'](event.gymId).directions">
              <svg aria-label="directions" xmlns="http://www.w3.org/2000/svg" width="44" height="44" viewBox="0 0 44 44">
                <path fill="#BFF683" d="M43.9589189,21.3944595 L24.4325676,1.86689189 L24.4325676,1.86689189 C24.0365279,1.45044614 23.4869924,1.21469515 22.9122973,1.21469515 C22.3376022,1.21469515 21.7880667,1.45044614 21.392027,1.86689189 L1.86689189,21.3944595 C1.45044614,21.7904992 1.21469515,22.3400346 1.21469515,22.9147297 C1.21469515,23.4894249 1.45044614,24.0389603 1.86689189,24.435 L21.3944595,43.9601351 L21.3944595,43.9601351 C21.7904992,44.3765809 22.3400346,44.6123319 22.9147297,44.6123319 C23.4894249,44.6123319 24.0389603,44.3765809 24.435,43.9601351 L43.9589189,24.4325676 C44.3745878,24.0366005 44.6098379,23.4875958 44.6098379,22.9135135 C44.6098379,22.3394312 44.3745878,21.7904265 43.9589189,21.3944595 Z M27.252973,28.3390541 L27.252973,22.9147297 L18.5740541,22.9147297 L18.5740541,29.4239189 L14.2297297,29.4239189 L14.2297297,20.7437838 C14.1941808,20.1581594 14.4113364,19.5853832 14.8261977,19.170522 C15.2410589,18.7556608 15.8138351,18.5385052 16.3994595,18.5740541 L27.2481081,18.5740541 L27.2481081,13.1497297 L34.8421622,20.7437838 L27.252973,28.3390541 Z" transform="translate(-1 -1)"/>
              </svg>
            </a>
          </li>
        </ul>
        <div>
          <svg xmlns="http://www.w3.org/2000/svg" width="28" height="30" viewBox="0 0 28 30">
            <g fill="#FFF">
              <circle cx="14.367" cy="6.551" r="6.551"/>
              <path d="M27.855,21.419 C27.855,25.279 18.055,22.179 14.544,28.408 C11.856,33.171 -1.456,26.183 1.233,21.419 C3.146,18.029 7.192,14.43 14.544,14.43 C21.896,14.43 27.855,17.559 27.855,21.419 Z"/>
            </g>
          </svg>
          <p>Skapad av: <br /> {{ event.creator }}</p>
        </div>
      </nav>
      <p>{{ event.description }}</p>
    </footer>
  </section>
</template>

<script>
export default {
  props: ['event'],
  data() {
    return {
      share: false
    }
  },
  computed: {
    daysLeft() {
      let date = new Date

      const months = {
          'Januari': 'Jan',
          'Februari': 'Feb',
          'Mars': 'Mar',
          'April': 'Apr',
          'Maj': 'May',
          'Juni': 'Jun',
          'Juli': 'Jul',
          'Augusti': 'Aug',
          'September': 'Sep',
          'Oktober': 'Oct',
          'November': 'Now',
          'December': 'Dec'
      }

      let monthOfEvent = months[this.event.date.month]
      let deadline = new Date(`${monthOfEvent} ${this.event.date.day}, ${this.event.date.year}`).getTime(); 
      let now = new Date().getTime()

      let time = deadline - now

      let days = Math.floor(time / (1000 * 60 * 60 * 24)) + 1

      days = this.formatNumber(days)

      return days
    }
  },
  methods: {
    formatNumber(n) {
      return n > 9 ? "" + n: "0" + n;
    },
    formatName(n) {
      let formatedName = n.toLowerCase()
      formatedName = formatedName
        .replace(/ /g,"-")
        .replace(/å/g, 'a')
        .replace(/Å/g, 'a')
        .replace(/ä/g, 'a')
        .replace(/Ä/g, 'a')
        .replace(/ö/g, 'o')
        .replace(/Ö/g, 'o');
      return formatedName
    }
  }
}
</script>

<style lang="scss" scoped>
@import '@/assets/scss/config.scss';

.event {
  header {
    display: flex;
    align-items: center;

    h1 {
      font-size: 45px;
      width: 100%;
      text-align: center;
    }
  }

  &__time {
    width: auto;
    padding: 0 8px;
  }

  &__hero {
    height: 200px;
    object-fit: cover;
    margin: 10px 0;
  }

  &__details {
    h3 {
      cursor: pointer;
    }

    div:first-of-type {
      flex: 0 0 35%;
    }

    div:last-of-type {
      flex: 1 1 65%;
      font-size: 20px;
    }
  }

  &__footer {
    margin: 10px 0px;
    

    nav {
      display: flex;

      > ul {
        flex: 0 0 35%;
        justify-content: center;
        position: relative;

        > li:not(:last-child) {
          margin-right: 10px;
        }
      } 

      > div {
        display: flex;
        align-items: center;
        text-align: center;
        flex: 1 1 65%;
        justify-content: center;

        > svg {
          margin-left: 10px;
          height: 40px;
          width: 40px;
        }

        > p {
          margin-left: 10px;
        }
      }
    }

    ul {
      display: flex;
      align-items: center;

      li {
        svg {
          height: 30px;
          widows: 30px;
          
        }
      }
    }

    > p {
      margin: 10px 0;
    }
  }

  &__social {
    display: flex;
    position: absolute;
    width: auto;
    padding: 12px 4px 8px;
    top: calc(100%);
    left: 0;
    border-bottom-left-radius: $border-radius-md;
    border-bottom-right-radius: $border-radius-md;
    z-index: 1;

    svg {
      height: 100%;
      max-height: 28px;
    }

    &-enter-active {
      animation: slide-down .2s forwards;
    }

    &-leave-active {
      animation: slide-down .2s reverse forwards;
    }

    @keyframes slide-down {
      from {
        max-height: 0px;
      }

      to {
        max-height: 48px;
      }
    }
  }
}
</style>
